(()=>{var S=Object.create;var m=Object.defineProperty;var T=Object.getOwnPropertyDescriptor;var _=Object.getOwnPropertyNames;var z=Object.getPrototypeOf,L=Object.prototype.hasOwnProperty;var U=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),F=(e,t)=>{for(var n in t)m(e,n,{get:t[n],enumerable:!0})},N=(e,t,n,l)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of _(t))!L.call(e,s)&&s!==n&&m(e,s,{get:()=>t[s],enumerable:!(l=T(t,s))||l.enumerable});return e};var h=(e,t,n)=>(n=e!=null?S(z(e)):{},N(t||!e||!e.__esModule?m(n,"default",{value:e,enumerable:!0}):n,e)),j=e=>N(m({},"__esModule",{value:!0}),e);var p=U((ie,R)=>{R.exports=shelter.solidWeb});var ae={};F(ae,{onUnload:()=>se,settings:()=>te});var v=`
.ys-ts-span2{grid-column-end:span 2;justify-self:center}`;var D=h(p(),1),u=h(p(),1),r=h(p(),1),E=h(p(),1),A=(0,D.template)('<div style="display: grid; align-items: baseline; grid-template-columns: 1fr auto auto auto auto; column-gap: .5rem"></div>',2),Y=(0,D.template)("<div></div>",2),{openModal:G,Header:c,HeaderTags:i,Button:d,ButtonSizes:x,ButtonLooks:f,ButtonColors:P,Divider:W,ModalRoot:J,ModalBody:K,ModalHeader:Q,ModalConfirmFooter:V,ModalSizes:X,TextBox:y,Text:Z,LinkButton:$,openConfirmationModal:q}=shelter.ui,{createSignal:C}=shelter.solid,{store:o}=shelter.plugin,M=(e,t)=>G(n=>{let l=o.regexes[e],[s,a]=C(l[0]),[g,O]=C(l[1]),[b,B]=C(l[2]),[I,H]=C(l[3]);return(0,r.createComponent)(J,{get size(){return X.MEDIUM},get children(){return[(0,r.createComponent)(Q,{get close(){return n.close},get children(){return[t?"Adding":"Editing",' "',(0,E.memo)(()=>s()),'"']}}),(0,r.createComponent)(K,{get children(){return[(0,r.createComponent)(c,{get tag(){return i.H3},children:"Name"}),(0,r.createComponent)(y,{placeholder:"Name",get value(){return s()},onInput:a}),(0,r.createComponent)(c,{get tag(){return i.H3},children:"Regular Expression Matcher"}),(0,r.createComponent)(y,{placeholder:"Regex",get value(){return g()},onInput:O}),(0,r.createComponent)(Z,{style:"margin: .25rem 0 .75rem; display: block",get children(){return["Struggling? You can test your regexes"," ",(0,r.createComponent)($,{href:"https://regexr.com",children:"at regexr.com"}),", and learn regex at"," ",(0,r.createComponent)($,{href:"https://regexlearn.com",children:"regexlearn.com"}),"."]}}),(0,r.createComponent)(c,{get tag(){return i.H3},children:"Regex Flags"}),(0,r.createComponent)(y,{placeholder:"Flags",get value(){return b()},onInput:B}),(0,r.createComponent)(c,{get tag(){return i.H3},children:"Replacement String"}),(0,r.createComponent)(y,{placeholder:"Replacement",get value(){return I()},onInput:H})]}}),(0,r.createComponent)(V,{get close(){return n.close},onCancel:()=>{o.regexes.splice(e,1),o.regexes=o.regexes},onConfirm:()=>{o.regexes[e]=[s(),g(),b(),I()],o.regexes=o.regexes},confirmText:"Save",cancelText:"Delete"})]}})}),ee=()=>M(o.regexes.push(["","","gi",""])-1,!0);function k(e,t){let n=o.regexes[e];o.regexes[e]=o.regexes[t],o.regexes[t]=n,o.regexes=o.regexes}var te=()=>[(()=>{let e=A.cloneNode(!0);return(0,u.insert)(e,(0,r.createComponent)(c,{get tag(){return i.H4},children:"Name"}),null),(0,u.insert)(e,(0,r.createComponent)(c,{get tag(){return i.H4},class:"ys-ts-span2",children:"Order"}),null),(0,u.insert)(e,(0,r.createComponent)(c,{get tag(){return i.H4},class:"ys-ts-span2",children:"Actions"}),null),(0,u.insert)(e,()=>o.regexes.map(([t,n,l,s],a)=>[(()=>{let g=Y.cloneNode(!0);return(0,u.insert)(g,t),g})(),(0,r.createComponent)(d,{"aria-label":`Move replacement "${t}" up one`,disabled:a===0,get look(){return f.OUTLINED},get size(){return x.ICON},grow:!0,onClick:()=>k(a,a-1),children:"\u25B2"}),(0,r.createComponent)(d,{"aria-label":`Move replacement "${t}" down one`,get disabled(){return a+1===o.regexes.length},get look(){return f.OUTLINED},get size(){return x.ICON},grow:!0,onClick:()=>k(a,a+1),children:"\u25BC"}),(0,r.createComponent)(d,{"aria-label":`Edit replacement "${t}"`,get look(){return f.OUTLINED},get size(){return x.ICON},grow:!0,style:{"font-family":"emoji"},onClick:()=>M(a),children:"\u270F"}),(0,r.createComponent)(d,{"aria-label":`Delete replacement "${t}"`,get look(){return f.OUTLINED},get size(){return x.ICON},get color(){return P.RED},style:{"font-family":"emoji"},grow:!0,onClick:()=>q({type:"danger",header:()=>`Delete ${t}?`,body:()=>"You won't be able to recover any replacements you delete.",confirmText:"Delete"}).then(()=>{o.regexes.splice(a,1),o.regexes=o.regexes},()=>{}),children:"\u{1F5D1}"})]),null),e})(),(0,r.createComponent)(W,{mt:!0,mb:!0}),(0,r.createComponent)(d,{grow:!0,onClick:ee,children:"Add replacement"})];var{http:{intercept:re},plugin:{store:w},ui:{injectCss:ne}}=shelter;w.regexes??=[];var oe=re("post",/\/channels\/\d+\/messages/,(e,t)=>{let n=e?.body?.content;try{if(typeof n=="string"){for(let[,l,s,a]of w.regexes){let g=new RegExp(l,s);n=n[g.global?"replaceAll":"replace"](g,a)}e.body.content=n}}catch(l){console.error("[shelter/text-replacements] BIG OOPSIE while replacing, sending request as-is!",e,l)}return t(e)}),le=ne(v),se=()=>(le(),oe());return j(ae);})();
