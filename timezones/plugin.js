(()=>{var P=Object.create;var i=Object.defineProperty;var D=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var G=Object.getPrototypeOf,O=Object.prototype.hasOwnProperty;var R=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),U=(e,t)=>{for(var n in t)i(e,n,{get:t[n],enumerable:!0})},d=(e,t,n,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of y(t))!O.call(e,s)&&s!==n&&i(e,s,{get:()=>t[s],enumerable:!(o=D(t,s))||o.enumerable});return e};var u=(e,t,n)=>(n=e!=null?P(G(e)):{},d(t||!e||!e.__esModule?i(n,"default",{value:e,enumerable:!0}):n,e)),$=e=>d(i({},"__esModule",{value:!0}),e);var c=R((V,f)=>{f.exports=shelter.solidWeb});var Z={};U(Z,{onUnload:()=>L});var h=u(c()),l=u(c());var p={[-9]:["AKST"],[-8]:["PST"],[-7]:["MST"],[-6]:["CT","CST"],[-5]:["ET","EST"],[-4]:["EDT"],[-3]:["AMST","ART","BRT","SRT","UYT","WGT"],[-2]:["FNT","PMDT"],[-1]:["AZOT","CVT","EGT"],0:["UTC","GMT","WET"],1:["CET","MET","WAT"],2:["CAT","EET","KALT","SAST","WAST"],3:["AST","EAT","FET","IOT","MSK","TRT"],4:["RET","AMT"],5:["MVT","PKT","TJT","TMT","UZT"],5.5:["IST"],7:["THA","WIB"],8:["AWST","CST","HKT","MST","MYT","SGT","WST"],9:["JST","KST"],9.5:["ACST"],10:["AEST","AET","VLAT"],12:["NZST"]},W=Object.values(p).flat(),z=Object.fromEntries(Object.entries(p).flatMap(([e,t])=>t.map(n=>[n,parseFloat(e)]))),F=new RegExp(`(${W.join("|")})(?:([+-]\\d+)(?::(\\d+))?)?`),T=e=>{if(!e)return;let t=e.match(F);if(!t)return;let[,n,o,s]=t;return z[n]+parseFloat(o??0)+parseFloat(s??0)/60};var K=(0,h.template)('<time class="ys_tz"> (Theirs: <!>:<!>)</time>',4),{flux:{dispatcher:_,stores:a},observeDom:w,util:{getFiber:b,reactFiberWalker:M}}=shelter,A=new Set;async function j(e,t){if(A.has(t))return;let n=M(b(e),o=>o.stateNode?.handlePreload,!0)?.stateNode;!n||(n.handlePreload(),A.add(t))}var B=(e,t)=>T(a.UserProfileStore.getUserProfile(e)?.bio)??T(a.UserProfileStore.getGuildMemberProfile(e,t)?.bio)??T(a.NoteStore.getNote(e)?.note),S=new Set;async function I(e){if(e.parentElement.querySelector(".ys_tz")||S.has(e))return;let t=M(b(e),"message",!0)?.memoizedProps?.message,n=t?.timestamp?.clone();if(!n)return;S.add(e),await j(e.parentElement.parentElement.querySelector("[id^=message-username]").firstElementChild,t.author.id),S.delete(e);let o=B(t.author.id,a.ChannelStore.getChannel(t.channel_id)?.guild_id);!o||(n.utc(),n.hours(n.hours()+o),Date.now()-Date.parse(n.toISOString())>1e3*60*60*24)||e.parentElement.append((()=>{let r=K.cloneNode(!0),x=r.firstChild,m=x.nextSibling,N=m.nextSibling,E=N.nextSibling,H=E.nextSibling;return(0,l.insert)(r,()=>n.hours(),m),(0,l.insert)(r,()=>n.minutes(),E),r})())}function g(){let e=w("h3 time[id^=message-timestamp]",t=>{e(),I(t)});setTimeout(e,500)}var C=["MESSAGE_CREATE","CHANNEL_SELECT","LOAD_MESSAGES_SUCCESS","UPDATE_CHANNEL_DIMENSIONS","MESSAGE_END_EDIT","MESSAGE_UPDATE"];C.forEach(e=>_.subscribe(e,g));var L=()=>C.forEach(e=>_.unsubscribe(e,g));return $(Z);})();
