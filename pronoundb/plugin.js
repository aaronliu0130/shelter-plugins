(()=>{var k=Object.create;var i=Object.defineProperty;var v=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var N=Object.getPrototypeOf,F=Object.prototype.hasOwnProperty;var M=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),U=(e,t)=>{for(var o in t)i(e,o,{get:t[o],enumerable:!0})},p=(e,t,o,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of x(t))!F.call(e,n)&&n!==o&&i(e,n,{get:()=>t[n],enumerable:!(s=v(t,n))||s.enumerable});return e};var h=(e,t,o)=>(o=e!=null?k(N(e)):{},p(t||!e||!e.__esModule?i(o,"default",{value:e,enumerable:!0}):o,e)),B=e=>p(i({},"__esModule",{value:!0}),e);var c=M((V,m)=>{m.exports=shelter.solidWeb});var J={};U(J,{onUnload:()=>z});var w=h(c(),1),a=h(c(),1),l=h(c(),1);var{reactFiberWalker:$,getFiber:j}=shelter.util,d=new Map;async function g(e,t){let o=d.get(t);if(o)return o;let s=$(j(e),C=>C.stateNode?.handlePreload,!0)?.stateNode;if(!s)return;let n=s.handlePreload();return d.set(t,n),n}var D=shelter.flux.stores.UserProfileStore,y={unspecified:"Unspecified",hh:"he/him",hi:"he/it",hs:"he/she",ht:"he/they",ih:"it/him",ii:"it/its",is:"it/she",it:"it/they",shh:"she/he",sh:"she/her",si:"she/it",st:"she/they",th:"they/he",ti:"they/it",ts:"they/she",tt:"they/them",any:"Any pronouns",other:"Other pronouns",ask:"Ask me my pronouns",avoid:"Avoid pronouns, use my name"},I=Object.values(y).filter(e=>e.includes("/")).sort((e,t)=>t.length-e.length),E=e=>{let t=D.getUserProfile(e);if(typeof t?.bio!="string")return;let o=t.bio.toLowerCase();return I.find(s=>o.includes(s))},G="https://pronoundb.org/api/v1/lookup-bulk?platform=discord&ids=",u=new Map,f=!1,r=new Map,L=150,O=async()=>{let e=u;u=new Map;let t=[...e.keys()].join();try{let o=await fetch(G+t).then(s=>s.json());for(let s in o)if(e.has(s)&&o[s]&&o[s]!=="unspecified"){let n=y[o[s]];e.get(s)?.(n),r.set(s,n)}for(let[s,n]of e.entries())n(void 0),r.has(s)||r.set(s,void 0)}finally{f=!1}},b=e=>r.has(e)?Promise.resolve(r.get(e)):new Promise(t=>{setTimeout(t,3e3),u.set(e,t),f||(f=!0,setTimeout(O,L))});var W=(0,w.template)("<span> \u2022</span>",2),{flux:{dispatcher:A},observeDom:H,util:{getFiber:R,reactFiberWalker:q},ui:{Space:S}}=shelter,P=new WeakSet;async function Q(e){if(P.has(e))return;P.add(e);let t=q(R(e),"message",!0)?.pendingProps?.message?.author?.id;if(!t)return;let o=await b(t);o||(await g(e.parentElement.parentElement.querySelector("[id^=message-username]").firstElementChild,t),o=E(t)),o&&e.insertAdjacentElement("beforebegin",(()=>{let s=W.cloneNode(!0),n=s.firstChild;return(0,a.insert)(s,(0,l.createComponent)(S,{}),n),(0,a.insert)(s,o,n),(0,a.insert)(s,(0,l.createComponent)(S,{}),null),s})())}function _(){let e=H("h3 time[id^=message-timestamp]",t=>{e(),Q(t)});setTimeout(e,500)}var T=["MESSAGE_CREATE","CHANNEL_SELECT","UPDATE_CHANNEL_DIMENSIONS","MESSAGE_UPDATE"];T.forEach(e=>A.subscribe(e,_));var z=()=>T.forEach(e=>A.unsubscribe(e,_));return B(J);})();
