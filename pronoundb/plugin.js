(()=>{var P=Object.create;var i=Object.defineProperty;var v=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var k=Object.getPrototypeOf,w=Object.prototype.hasOwnProperty;var M=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),N=(e,t)=>{for(var n in t)i(e,n,{get:t[n],enumerable:!0})},l=(e,t,n,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of C(t))!w.call(e,o)&&o!==n&&i(e,o,{get:()=>t[o],enumerable:!(s=v(t,o))||s.enumerable});return e};var a=(e,t,n)=>(n=e!=null?P(k(e)):{},l(t||!e||!e.__esModule?i(n,"default",{value:e,enumerable:!0}):n,e)),x=e=>l(i({},"__esModule",{value:!0}),e);var h=M((Q,m)=>{m.exports=shelter.solidWeb});var W={};N(W,{onUnload:()=>R});var S=a(h(),1),c=a(h(),1),p=a(h(),1);var{UserProfileStore:U}=shelter.flux.stores,d={unspecified:"Unspecified",hh:"he/him",hi:"he/it",hs:"he/she",ht:"he/they",ih:"it/him",ii:"it/its",is:"it/she",it:"it/they",shh:"she/he",sh:"she/her",si:"she/it",st:"she/they",th:"they/he",ti:"they/it",ts:"they/she",tt:"they/them",any:"Any pronouns",other:"Other pronouns",ask:"Ask me my pronouns",avoid:"Avoid pronouns, use my name"},$=Object.values(d).filter(e=>e.includes("/")).sort((e,t)=>t.length-e.length),y=e=>{let t=U.getUserProfile(e);if(typeof t?.bio=="string")return $.find(n=>t.bio.includes(n))},j="https://pronoundb.org/api/v1/lookup-bulk?platform=discord&ids=",u=new Map,f=!1,r=new Map,D=150,I=async()=>{let e=u;u=new Map;let t=[...e.keys()].join();try{let n=await fetch(j+t).then(s=>s.json());for(let s in n)if(e.has(s)&&n[s]&&n[s]!=="unspecified"){let o=d[n[s]];e.get(s)?.(o),r.set(s,o)}for(let[s,o]of e.entries())o(void 0),r.has(s)||r.set(s,void 0)}finally{f=!1}},E=e=>r.has(e)?Promise.resolve(r.get(e)):new Promise(t=>{setTimeout(t,3e3),u.set(e,t),f||(f=!0,setTimeout(I,D))});var G=(0,S.template)("<span> \u2022</span>",2),{flux:{dispatcher:A},observeDom:O,util:{getFiber:B,reactFiberWalker:H},ui:{Space:g}}=shelter,b=new WeakSet;async function L(e){if(b.has(e))return;b.add(e);let t=H(B(e),"message",!0)?.pendingProps?.message?.author?.id;if(!t)return;let n=await E(t)??y(t);n&&e.insertAdjacentElement("beforebegin",(()=>{let s=G.cloneNode(!0),o=s.firstChild;return(0,c.insert)(s,(0,p.createComponent)(g,{}),o),(0,c.insert)(s,n,o),(0,c.insert)(s,(0,p.createComponent)(g,{}),null),s})())}function _(){let e=O("h3 time[id^=message-timestamp]",t=>{e(),L(t)});setTimeout(e,500)}var T=["MESSAGE_CREATE","CHANNEL_SELECT","UPDATE_CHANNEL_DIMENSIONS","MESSAGE_UPDATE"];T.forEach(e=>A.subscribe(e,_));var R=()=>T.forEach(e=>A.unsubscribe(e,_));return x(W);})();
